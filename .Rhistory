cat(paste0("Package ", pkg, " loaded\n"))
}
})
)
}
unloadNamespace("fs")
unloadNamespace("box")
check_inst_pkg(c("fs", "box"))
#' @export check_inst_pkg
#'
#' @description
#' Check if `pkg` is installed. If not, package is installed with
#' `install.packages(dependencies = TRUE)` and loaded with
#' `library(pkg, character.only = TRUE)`
#'
#' @examples
#' check_inst_pkg("fs")
check_inst_pkg <- function(pkg) {
pkg_check <- suppressWarnings(
suppressMessages(
suppressPackageStartupMessages(
lapply(X = pkg, FUN = function(x) {
if (!isNamespaceLoaded(x)) {
if (requireNamespace(x, quietly = TRUE))
cat(paste0("Loading package: ", pkg, "\n"))
else
stop(paste0(pkg, " not available\n"))
} else {
cat(paste0("Package ", pkg, " loaded\n"))
}
})
)
}
unloadNamespace("fs")
unloadNamespace("box")
check_inst_pkg(c("fs", "box"))
#' @export check_inst_pkg
#'
#' @description
#' Check if `pkg` is installed. If not, package is installed with
#' `install.packages(dependencies = TRUE)` and loaded with
#' `library(pkg, character.only = TRUE)`
#'
#' @examples
#' check_inst_pkg("fs")
check_inst_pkg <- function(pkg) {
suppressWarnings(
suppressMessages(
suppressPackageStartupMessages(
lapply(X = pkg, FUN = function(x) {
if (!isNamespaceLoaded(x)) {
if (requireNamespace(x, quietly = TRUE)) {
cat(paste0("Loading package: ", pkg, "\n"))
} else {
stop(paste0(pkg, " not available\n"))
}
} else {
cat(paste0("Package ", pkg, " loaded\n"))
}
})
)
}
check_inst_pkg(c("fs", "box"))
#' @export check_inst_pkg
#'
#' @description
#' Check if `pkg` is installed. If not, package is installed with
#' `install.packages(dependencies = TRUE)` and loaded with
#' `library(pkg, character.only = TRUE)`
#'
#' @examples
#' check_inst_pkg("fs")
check_inst_pkg <- function(pkg) {
lapply(X = pkg, FUN = function(x) {
if (!isNamespaceLoaded(x)) {
if (requireNamespace(x, quietly = TRUE)) {
cat(paste0("Loading package: ", pkg, "\n"))
} else {
stop(paste0(pkg, " not available\n"))
}
} else {
cat(paste0("Package ", pkg, " loaded\n"))
}
})
}
unloadNamespace("fs")
unloadNamespace("box")
check_inst_pkg(c("fs", "box"))
check_inst_pkg <- function(pkg) {
if (!isNamespaceLoaded(pkg)) {
if (requireNamespace(pkg, quietly = TRUE)) {
cat(paste0("Loading package: ", pkg, "\n"))
} else {
stop(paste0(pkg, " not available\n"))
}
} else {
cat(paste0("Package ", pkg, " loaded\n"))
}
unloadNamespace("fs")
unloadNamespace("box")
check_inst_pkg(c("fs", "box"))
check_inst_pkg <- function(pkg) {
if (!isNamespaceLoaded(pkg)) {
if (requireNamespace(pkg, quietly = TRUE)) {
cat(paste0("Loading package: ", pkg))
} else {
stop(paste0(pkg, " not available"))
}
} else {
cat(paste0("Package ", pkg, " loaded\n"))
}
check_inst_pkg(c("fs", "box"))
check_inst_pkg <- function(pkg) {
if (!isNamespaceLoaded(pkg)) {
if (requireNamespace(pkg, quietly = TRUE)) {
cat(paste0("Loading package: ", pkg))
} else {
stop(paste0(pkg, " not available"))
}
} else {
cat(paste0("Package ", pkg, " loaded"))
}
check_inst_pkg(c("fs", "box"))
check_inst_pkg <- function(pkg) {
if (!isNamespaceLoaded(pkg)) {
if (requireNamespace(pkg, quietly = TRUE)) {
cat(paste0("Loading package: ", pkg))
} else {
stop(paste0(pkg, " not available"))
}
} else {
cat(paste0("Package ", pkg, " loaded\n"))
}
check_inst_pkg(c("fs", "box"))
unloadNamespace("fs")
unloadNamespace("box")
check_inst_pkg(c("fs", "box"))
unloadNamespace("fs")
unloadNamespace("box")
unloadNamespace("lubridate")
unloadNamespace("fs")
unloadNamespace("forcats")
source("~/projects/apps/dbap/R/get_data.R", echo=TRUE)
objname
e
ls()
x
pkg
dataname
ls()
e
data(list = dataname, package = pkg, envir = e)
ls()
get(objname, envir = e)
library(stringr)
str_view_all(" .*", "BJsales.lead (BJsales)")
str_view_all("BJsales.lead (BJsales)", " .*")
str_remove_all("BJsales.lead (BJsales)", " .*")
str_view_all("BJsales.lead (BJsales)", "^.*\\(")
str_remove_all("BJsales.lead (BJsales)", "^.*\\(")
str_remove_all("BJsales.lead (BJsales)", "\\)$")
dataname <- sub("^.*\\(", "", "BJsales.lead (BJsales)")
sub("\\)$", "", dataname)
dataname
str_extract("BJsales.lead (BJsales)", "^.*\\(")
!str_extract("BJsales.lead (BJsales)", "^.*\\(")
str_sub("BJsales.lead (BJsales)", "^.*\\(")
sub("BJsales.lead (BJsales)", "^.*\\(")
sub("^.*\\(", "BJsales.lead (BJsales)")
sub("^.*\\(", "", "BJsales.lead (BJsales)")
dataname <- sub("^.*\\(", "", "BJsales.lead (BJsales)")
sub("\\)$", "", dataname)
sub("^.*\\(", "BJsales.lead (BJsales)")
str_replace_all(string = "BJsales.lead (BJsales)", pattern = "^.*\\(", replacement = "")
str_replace_all(string = "BJsales.lead (BJsales)", pattern = "^.*\\(|\\)$", replacement = "")
source("~/projects/apps/dbap/R/get_data.R", echo=TRUE)
objname
e
dataname
e
ls()
e
source("~/projects/apps/dbap/R/get_data.R", echo=TRUE)
objname
BJsales.lead
source("~/projects/apps/dbap/R/get_data.R", echo=TRUE)
objname
e
ls()
e
obj_addr()
source("~/projects/apps/dbap/R/get_data.R", echo=TRUE)
2
e
unloadNamespace("forcats")
source("~/projects/apps/dbap/R/get_data.R", echo=TRUE)
e
dataname
source("~/projects/apps/dbap/R/get_data.R", echo=TRUE)
#' @param x name of dataset
#' @param pkg name of package
#'
#' @return data object
#'
#' @export get_data
#'
#' @examples
#' get_data("gss_cat", "forcats")
#' get_data("starwars", "dplyr")
get_data <- function(ds, pkg) {
browser()
objname <- stringr::str_remove_all(ds, " .*")
e <- loadNamespace(pkg)
if (!exists(ds, envir = e)) {
dataname <- stringr::str_replace_all(ds, "^.*\\(|\\)$", "")
e <- new.env()
data(list = dataname, package = pkg, envir = e)
}
get(objname, envir = e)
}
get_data("gss_cat", "forcats")
#' @param x name of dataset
#' @param pkg name of package
#'
#' @return data object
#'
#' @export get_data
#'
#' @examples
#' get_data("gss_cat", "forcats")
#' get_data("starwars", "dplyr")
get_data <- function(ds, pkg) {
objname <- stringr::str_remove_all(ds, " .*")
e <- loadNamespace(pkg)
if (!exists(ds, envir = e)) {
dataname <- stringr::str_replace_all(ds, "^.*\\(|\\)$", "")
e <- new.env()
data(list = dataname, package = pkg, envir = e)
}
data_obj <- get(objname, envir = e)
class(data_obj)
}
get_data("starwars", "dplyr")
source("~/projects/apps/dbap/R/get_data.R", echo=TRUE)
e
dataname
e
data_obj
str(data_obj)
devtools::load_all()
devtools::document()
devtools::load_all()
devtools::document()
isNamespaceLoaded("fs")
source("~/projects/apps/dbap/R/check_inst_pkg.R", echo=TRUE)
unloadNamespace("fs")
isNamespaceLoaded("fs")
source("~/projects/apps/dbap/R/check_inst_pkg.R", echo=TRUE)
pkg
isNamespaceLoaded("fs")
source("~/projects/apps/dbap/R/check_inst_pkg.R", echo=TRUE)
unloadNamespace("fs")
source("~/projects/apps/dbap/R/check_inst_pkg.R", echo=TRUE)
isNamespaceLoaded("fs")
devtools::load_all()
library(dbap)
get_df_col_count <- function(df, type) {
switch(EXPR = type,
chr = ncol(dplyr::select(df, where(is.character))),
num = ncol(dplyr::select(df, where(is.numeric))),
fct = ncol(dplyr::select(df, where(is.factor))),
log = ncol(dplyr::select(df, where(is.logical))),
lst = ncol(dplyr::select(df, where(is.list)))
)
}
get_df_col_count(mtcars, "num")
get_df_col_count(mtcars, "chr")
get_df_col_count(dplyr::starwars, "chr")
get_df_col_count(dplyr::starwars, "lst")
devtools::document()
devtools::load_all()
devtools::document()
library(dbap)
devtools::load_all()
devtools::document()
library(dbap)
source("~/projects/apps/dbap/R/check_inst_pkg.R", echo=TRUE)
isNamespaceLoaded("roxygen2Comment")
source("~/projects/apps/dbap/R/check_inst_pkg.R", echo=TRUE)
isNamespaceLoaded("roxygen2Comment")
source("~/projects/apps/dbap/R/check_inst_pkg.R", echo=TRUE)
pkgs
source("~/projects/apps/dbap/R/check_inst_pkg.R", echo=TRUE)
pkgs
isNamespaceLoaded("fs")
source("~/projects/apps/dbap/R/check_inst_pkg.R", echo=TRUE)
pkgs
lsf.str("package:dplyr")
requireNamespace("dplyr")
lsf.str("package:dplyr")
library("dplyr")
lsf.str("package:dplyr")
ls("package:dplyr")
ls(getNamespace("TCGAGBM"),all.names=TRUE)
ls(getNamespace("dplyr"),all.names=TRUE)
lsf.str(getNamespace("dplyr"),all.names=TRUE)
getNamespace("dplyr")
ls(getNamespace("dplyr"), all.names = TRUE)
ls("package:dplyr")
lsf.str("package:dplyr")
dplyr_ns <- lsf.str("package:dplyr")
library(stringr)
str_view_all(dplyr_ns, "starwars")
str_view_all(dplyr_ns, "starwars", match = TRUE)
str_view_all(dplyr_ns, "storms", match = TRUE)
data(package = "dplyr")$results
str(data(package = "dplyr"))
data(package = "dplyr")$footer
data(package = "dplyr")$results
#' @return metadata table of data object
#'
#' @export get_data_results
#'
#' @importFrom tibble as_tibble
#'
#' @examples
#' get_data_results("lubridate")
#' get_data_results("dplyr")
get_data_results <- function(pkg) {
# load packages
check_inst_pkg(pkg = pkg)
tibble::as_tibble(
data.frame(
Package = data(package = pkg)$results[, "Package"],
Item = data(package = pkg)$results[, "Item"],
Title = data(package = pkg)$results[, "Title"],
stringsAsFactors = FALSE,
check.names = FALSE,
row.names = NULL
)
}
get_data_results("dplyr")
devtools::load_all()
devtools::document()
library(dbap)
devtools::load_all()
devtools::document()
library(dbap)
get_data_results("dplyr")
get_data_results("lubridate")
ds <- get_data_results(pkg = "dplyr")
ds_list <- purrr::map2(
.x = ds[["Item"]], .y = ds[["Package"]],
.f = get_data, .progress = TRUE
)
ds <- get_data_results(pkg = c("dplyr", "lubridate"))
ds
ds_list <- purrr::map2(
.x = ds[["Item"]], .y = ds[["Package"]],
.f = get_data, .progress = TRUE
)
ds_list
dplyr::mutate(ds,
Class = purrr::map(.x = ds_list, .f = class) |>
purrr::map(paste0, collapse = ", ") |>
unlist(),
Columns = purrr::map(.x = ds_list, .f = ncol) |>
purrr::map(paste0, " columns") |>
unlist(),
Rows = purrr::map(.x = ds_list, .f = nrow) |>
purrr::map(paste0, " rows") |>
unlist())
dplyr::mutate(ds,
Class = purrr::map(.x = ds_list, .f = class) |>
purrr::map(paste0, collapse = ", ") |>
unlist(),
Columns = purrr::map(.x = ds_list, .f = ncol) |>
purrr::map(paste0, " columns") |>
unlist(),
Rows = purrr::map(.x = ds_list, .f = nrow) |>
purrr::map(paste0, " rows") |>
unlist(),
Logical = purrr::map(.x = ds_list, .f = get_df_col_count, "log") |>
unlist()
)
dplyr::mutate(ds,
Class = purrr::map(.x = ds_list, .f = class) |>
purrr::map(paste0, collapse = ", ") |>
unlist(),
Columns = purrr::map(.x = ds_list, .f = ncol) |>
purrr::map(paste0, " columns") |>
unlist(),
Rows = purrr::map(.x = ds_list, .f = nrow) |>
purrr::map(paste0, " rows") |>
unlist(),
Logical = purrr::map(.x = ds_list,
.f = get_df_col_count, "log") |>
unlist(),
Numeric = purrr::map(.x = ds_list,
.f = get_df_col_count, "num") |>
unlist()
)
dplyr::mutate(ds,
Class = purrr::map(.x = ds_list, .f = class) |>
purrr::map(paste0, collapse = ", ") |>
unlist(),
Columns = purrr::map(.x = ds_list, .f = ncol) |>
purrr::map(paste0, " columns") |>
unlist(),
Rows = purrr::map(.x = ds_list, .f = nrow) |>
purrr::map(paste0, " rows") |>
unlist(),
Logical = purrr::map(.x = ds_list,
.f = get_df_col_count, "log") |>
unlist(),
Numeric = purrr::map(.x = ds_list,
.f = get_df_col_count, "num") |>
unlist(),
Character = purrr::map(.x = ds_list,
.f = get_df_col_count, "chr") |>
unlist(),
Factor = purrr::map(.x = ds_list,
.f = get_df_col_count, "fct") |>
unlist(),
List = purrr::map(.x = ds_list,
.f = get_df_col_count, "lst") |>
unlist(),
)
devtools::load_all()
devtools::document()
library(dbap)
get_data_obj_metadata("lubridate")
get_data_obj_metadata("dplyr")
devtools::load_all()
devtools::document()
library(dbap)
devtools::load_all()
devtools::document()
library(dbap)
devtools::load_all()
devtools::document()
library(dbap)
devtools::load_all()
devtools::document()
library(dbap)
get_ds_str(c("dplyr", "forcats"))
get_ds_str(c("fs", "box"))
get_ds_str(c("dplyr", "forcats"))
source("~/projects/apps/dbap/R/check_inst_pkg.R", echo=TRUE)
unloadNamespace("roxygen2Comment")
source("~/projects/apps/dbap/R/check_inst_pkg.R", echo=TRUE)
b
data(package = "dplyr")
source("~/projects/apps/dbap/R/get_data_results.R", echo=TRUE)
isNamespaceLoaded("dplyr")
source("~/projects/apps/dbap/R/get_data_results.R", echo=TRUE)
devtools::load_all()
devtools::document()
library(dbap)
source("~/projects/apps/dbap/R/get_data_results.R", echo=TRUE)
devtools::load_all()
devtools::document()
library(dbap)
source("~/projects/apps/dbap/R/get_data_results.R", echo=TRUE)
unloadNamespace("fivethirtyeight")
isNamespaceLoaded("fivethirtyeight")
source("~/projects/apps/dbap/R/get_data_results.R", echo=TRUE)
devtools::load_all()
devtools::document()
library(dbap)
source("~/projects/apps/dbap/R/get_data_results.R", echo=TRUE)
install.packages("fivethirtyeight")
source("~/projects/apps/dbap/R/get_data_results.R", echo=TRUE)
devtools::load_all()
rm(list = c("get_data_results"))
devtools::load_all()
devtools::document()
library(dbap)
source("~/projects/apps/dbap/R/get_data_results.R", echo=TRUE)
d
devtools::load_all()
devtools::document()
library(dbap)
unloadNamespace("fivethirtyeight")
source("~/projects/apps/dbap/R/get_data_results.R", echo=TRUE)
devtools::load_all()
devtools::document()
library(dbap)
source("~/projects/apps/dbap/R/get_data_results.R", echo=TRUE)
"fivethirtyeight" %in% loadedNamespaces()
source("~/projects/apps/dbap/R/get_data_results.R", echo=TRUE)
pkg
pkg %in% loadedNamespaces()
source("~/projects/apps/dbap/R/get_data_results.R", echo=TRUE)
source("~/projects/apps/dbap/R/check_inst_pkg.R", echo=TRUE)
source("~/projects/apps/dbap/R/get_data_results.R", echo=TRUE)
devtools::load_all()
devtools::document()
library(dbap)
source("~/projects/apps/dbap/R/get_data_results.R", echo=TRUE)
devtools::load_all()
devtools::document()
library(dbap)
source("~/projects/apps/dbap/R/get_data_results.R", echo=TRUE)
devtools::load_all()
devtools::document()
library(dbap)
source("~/projects/apps/dbap/R/get_data_results.R", echo=TRUE)
isNamespaceLoaded(pkg)
devtools::load_all()
devtools::document()
library(dbap)
